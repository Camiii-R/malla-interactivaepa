<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Interactiva EPA 🌸</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: url('https://i.imgur.com/E0Luy3I.png') repeat;
      background-size: 300px;
    }

    h1 {
      text-align: center;
      padding: 20px;
      background-color: #ffd6ec;
      margin: 0;
      font-size: 28px;
      color: #5c2a4a;
    }

    .malla {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding: 20px;
      gap: 20px;
    }

    .semestre {
      background: #fff8f5;
      border: 2px solid #ffc0cb;
      border-radius: 16px;
      padding: 15px;
      min-width: 220px;
      flex-shrink: 0;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .semestre h2 {
      font-size: 16px;
      margin-top: 0;
      color: #b24971;
    }

    .ramo {
      padding: 6px 10px;
      margin: 5px 0;
      border-radius: 8px;
      cursor: pointer;
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      transition: transform 0.2s;
    }

    .ramo:hover {
      transform: scale(1.02);
    }

    .aprobado {
      background-color: #90ee90 !important;
    }

    .bloqueado {
      background-color: #d3d3d3 !important;
      pointer-events: none;
      opacity: 0.6;
    }

    /* Leyenda flotante */
    .leyenda-flotante {
      position: fixed;
      top: 100px;
      right: 30px;
      background-color: #fff8e7;
      border: 2px solid #f4d47c;
      padding: 12px;
      border-radius: 16px;
      width: 180px;
      z-index: 1000;
      font-family: 'Segoe UI', sans-serif;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .toggle-leyenda {
      background-color: #fddca5;
      border: none;
      border-radius: 10px;
      padding: 6px 10px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      margin-bottom: 10px;
      color: #5c4e2f;
    }

    .contenido-leyenda ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }

    .contenido-leyenda li {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
      color: #444;
    }

    .color-box {
      display: inline-block;
      width: 18px;
      height: 18px;
      margin-right: 8px;
      border-radius: 4px;
      border: 1px solid #aaa;
    }

    .color-box.aprobado {
      background-color: #90ee90;
    }

    .color-box.no-aprobado {
      background-color: #f0f0f0;
    }

    .color-box.bloqueado {
      background-color: #d3d3d3;
    }

    @media (max-width: 600px) {
      .leyenda-flotante {
        width: auto;
        right: 10px;
        top: auto;
        bottom: 20px;
        padding: 8px;
      }

      .contenido-leyenda {
        display: none;
      }

      .leyenda-flotante.open .contenido-leyenda {
        display: block;
      }
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva Educación Parvularia 🧸</h1>

  <div class="malla" id="malla"></div>

  <div class="leyenda-flotante" id="leyendaFlotante">
    <button class="toggle-leyenda" onclick="toggleLeyenda()">🦋 Leyenda</button>
    <div class="contenido-leyenda" id="contenidoLeyenda">
      <ul>
        <li><span class="color-box aprobado"></span> Aprobado</li>
        <li><span class="color-box no-aprobado"></span> Disponible</li>
        <li><span class="color-box bloqueado"></span> Bloqueado</li>
      </ul>
    </div>
  </div>

  <script>
    const ramos = {
      "Primer año - Semestre I": [
        "Fundamento de la educación parvularia",
        "Pensamiento pedagógico, persona y sociedad",
        "Lenguajes artísticos I: Arte y literatura",
        "Bases psicolingüísticas para el aprendizaje",
        "Aprendizaje humano"
      ],
      "Primer año - Semestre II": [
        "Políticas públicas y escenarios educativos",
        "Lenguajes artísticos II: Música y motricidad",
        "Habilidades comunicativas en el párvulo",
        "Factores cognitivos y socioafectivos del aprendizaje",
        "Diseño y adaptación curricular",
        "Electivo Antropológico"
      ],
      "Segundo año - Semestre III": [
        "Taller pedagógico I",
        "Planificación y evaluación del proceso de educativo",
        "Didáctica del lenguaje",
        "Construcción del pensamiento lógico matemático",
        "Evaluación y retroalimentación para el aprendizaje",
        "Electivo teológico"
      ],
      "Segundo año - Semestre IV": [
        "Taller pedagógico II",
        "Didáctica de las matemáticas",
        "Lenguajes artísticos integrados",
        "Formación ciudadana en el párvulo",
        "Corporalidad y movimiento",
        "Evaluación integrada I"
      ],
      "Tercer año - Semestre V": [
        "Taller pedagógico III",
        "Didáctica de las CS. sociales",
        "Salud del párvulo",
        "Construcción del pensamiento científico",
        "Seminario de enseñanza en aulas diversas",
        "Tic para el aprendizaje",
        "Electivo para la diversidad"
      ],
      "Tercer año - Semestre VI": [
        "Taller Pedagógico IV",
        "Didáctica de CS. naturales",
        "Familia y su integración",
        "Programas y exp. educativas",
        "Gestión educativa",
        "Electivo para la diversidad"
      ],
      "Cuarto año - Semestre VII": [
        "Taller pedagógico V",
        "Investigación educativa",
        "Trabajo pedagógico en contextos diversos",
        "Competencias en interculturalidad",
        "Diseño y evaluación de proyectos",
        "Desarrollo de las competencias emocionales del párvulo",
        "Evaluación integrada II"
      ],
      "Cuarto año - Semestre VIII": [
        "Internado pedagógico",
        "Seminario",
        "Ético profesional"
      ]
    };

    const prerequisitos = {
      "Políticas públicas y escenarios educativos": ["Pensamiento pedagógico, persona y sociedad"],
      "Lenguajes artísticos II: Música y motricidad": ["Lenguajes artísticos I: Arte y literatura"],
      "Factores cognitivos y socioafectivos del aprendizaje": ["Aprendizaje humano"],
      "Diseño y adaptación curricular": ["Aprendizaje humano"],
      "Evaluación y retroalimentación para el aprendizaje": ["Aprendizaje humano", "Diseño y adaptación curricular"],
      "Didáctica del lenguaje": ["Habilidades comunicativas en el párvulo"],
      "Didáctica de las matemáticas": ["Construcción del pensamiento lógico matemático", "Didáctica del lenguaje"],
      "Taller pedagógico II": ["Taller pedagógico I"],
      "Lenguajes artísticos integrados": ["Lenguajes artísticos II: Música y motricidad"],
      "Taller pedagógico III": ["Taller pedagógico II", "Taller pedagógico I"],
      "Didáctica de las CS. sociales": ["Formación ciudadana en el párvulo", "Didáctica de las matemáticas"],
      "Taller Pedagógico IV": ["Taller pedagógico III", "Taller pedagógico II", "Taller pedagógico I"],
      "Taller pedagógico V": ["Taller Pedagógico IV", "Taller pedagógico III", "Taller pedagógico II", "Taller pedagógico I"],
      "Trabajo pedagógico en contextos diversos": ["Familia y su integración"],
      "Competencias en interculturalidad": ["Programas y exp. educativas"],
      "Internado pedagógico": ["Taller pedagógico V", "Taller Pedagógico IV", "Taller pedagógico III", "Taller pedagógico II", "Taller pedagógico I"],
      "Seminario": ["Investigación educativa"]
    };

    const estado = JSON.parse(localStorage.getItem("estadoRamos") || "{}");

    function crearMalla() {
      const contenedor = document.getElementById("malla");
      contenedor.innerHTML = "";

      for (const [semestre, cursos] of Object.entries(ramos)) {
        const div = document.createElement("div");
        div.className = "semestre";
        const h2 = document.createElement("h2");
        h2.textContent = semestre;
        div.appendChild(h2);

        cursos.forEach(ramo => {
          const r = document.createElement("div");
          r.className = "ramo";
          r.textContent = ramo;

          const requisitos = prerequisitos[ramo] || [];
          const cumplidos = requisitos.every(pr => estado[pr]);
          if (requisitos.length > 0 && !cumplidos) {
            r.classList.add("bloqueado");
          }

          if (estado[ramo]) {
            r.classList.add("aprobado");
          }

          r.addEventListener("click", () => {
            if (r.classList.contains("bloqueado")) return;
            r.classList.toggle("aprobado");
            estado[ramo] = r.classList.contains("aprobado");
            localStorage.setItem("estadoRamos", JSON.stringify(estado));
            crearMalla();
          });

          div.appendChild(r);
        });

        contenedor.appendChild(div);
      }
    }

    function toggleLeyenda() {
      document.getElementById("leyendaFlotante").classList.toggle("open");
    }

    crearMalla();
  </script>
</body>
</html>
