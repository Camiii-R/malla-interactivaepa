<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Malla Interactiva Educación Parvularia</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Quicksand', sans-serif;
      margin: 0;
      padding: 1rem;
      background-color: #fdf6f9;
      color: #333;
      display: flex;
    }

    .container {
      flex: 1;
      max-width: 1000px;
      margin-left: 220px;
    }

    h2 {
      color: #b36b9c;
      margin-top: 2rem;
      border-bottom: 2px solid #e0c9dd;
      padding-bottom: 0.5rem;
    }

    .semester {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .course {
      background-color: #f3d1e0;
      border: 2px solid #dbaecf;
      border-radius: 10px;
      padding: 10px;
      margin: 5px;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.3s;
      flex: 1 1 calc(33% - 10px);
      box-sizing: border-box;
      text-align: center;
      user-select: none;
    }

    .course:hover {
      transform: scale(1.03);
    }

    .approved {
      background-color: #c7f5d3 !important;
      border-color: #95e6ad !important;
    }

    .locked {
      background-color: #e0e0e0 !important;
      border-color: #cccccc !important;
      cursor: not-allowed;
    }

    /* Leyenda fija */
    .leyenda {
      position: fixed;
      left: 0;
      top: 0;
      width: 200px;
      height: 100%;
      background: #fff0f7;
      padding: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
      box-sizing: border-box;
      font-size: 0.95rem;
    }

    .leyenda h3 {
      margin-top: 0;
      color: #a34f85;
    }

    .leyenda .item {
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }

    .leyenda .box {
      width: 20px;
      height: 20px;
      margin-right: 10px;
      border-radius: 4px;
    }

    .leyenda .ap { background: #c7f5d3; border: 1px solid #95e6ad; }
    .leyenda .noap { background: #f3d1e0; border: 1px solid #dbaecf; }
    .leyenda .bloq { background: #e0e0e0; border: 1px solid #cccccc; }
  </style>
</head>
<body>

  <div class="leyenda">
    <h3>Colores</h3>
    <div class="item"><div class="box ap"></div> Aprobado</div>
    <div class="item"><div class="box noap"></div> No aprobado</div>
    <div class="item"><div class="box bloq"></div> Bloqueado</div>
  </div>

  <div class="container" id="malla"></div>

  <script>
    const cursos = {
      "Primer año - Semestre I": [
        "Fundamento de la educación parvularia",
        "Pensamiento pedagógico, persona y sociedad",
        "Lenguajes artísticos I: Arte y literatura",
        "Bases psicolingüísticas para el aprendizaje",
        "Aprendizaje humano"
      ],
      "Primer año - Semestre II": [
        "Políticas públicas y escenarios educativos",
        "Lenguajes artísticos II: Música y motricidad",
        "Habilidades comunicativas en el párvulo",
        "Factores cognitivos y socioafectivos del aprendizaje",
        "Diseño y adaptación curricular",
        "Electivo Antropológico"
      ],
      "Segundo año - Semestre III": [
        "Taller pedagógico I",
        "Planificación y evaluación del proceso educativo",
        "Didáctica del lenguaje",
        "Construcción del pensamiento lógico matemático",
        "Evaluación y retroalimentación para el aprendizaje",
        "Electivo teológico"
      ],
      "Segundo año - Semestre IV": [
        "Taller pedagógico II",
        "Didáctica de las matemáticas",
        "Lenguajes artísticos integrados",
        "Formación ciudadana en el párvulo",
        "Corporalidad y movimiento",
        "Evaluación integrada I"
      ],
      "Tercer año - Semestre V": [
        "Taller pedagógico III",
        "Didáctica de las CS. sociales",
        "Salud del párvulo",
        "Construcción del pensamiento científico",
        "Seminario de enseñanza en aulas diversas",
        "Tic para el aprendizaje",
        "Electivo para la diversidad"
      ],
      "Tercer año - Semestre VI": [
        "Taller Pedagógico IV",
        "Didáctica de CS. naturales",
        "Familia y su integración",
        "Programas y exp. educativas",
        "Gestión educativa",
        "Electivo para la diversidad"
      ],
      "Cuarto año - Semestre VII": [
        "Taller pedagógico V",
        "Investigación educativa",
        "Trabajo pedagógico en contextos diversos",
        "Competencias en interculturalidad",
        "Diseño y evaluación de proyectos",
        "Desarrollo de las competencias emocionales del párvulo",
        "Evaluación integrada II"
      ],
      "Cuarto año - Semestre VIII": [
        "Internado pedagógico",
        "Seminario",
        "Ético profesional"
      ]
    };

    const prerrequisitos = {
      "Políticas públicas y escenarios educativos": ["Pensamiento pedagógico, persona y sociedad"],
      "Lenguajes artísticos II: Música y motricidad": ["Lenguajes artísticos I: Arte y literatura"],
      "Factores cognitivos y socioafectivos del aprendizaje": ["Aprendizaje humano"],
      "Diseño y adaptación curricular": ["Aprendizaje humano"],
      "Evaluación y retroalimentación para el aprendizaje": ["Aprendizaje humano", "Diseño y adaptación curricular"],
      "Didáctica del lenguaje": ["Habilidades comunicativas en el párvulo"],
      "Didáctica de las matemáticas": ["Construcción del pensamiento lógico matemático", "Didáctica del lenguaje"],
      "Taller pedagógico II": ["Taller pedagógico I"],
      "Lenguajes artísticos integrados": ["Lenguajes artísticos II: Música y motricidad"],
      "Taller pedagógico III": ["Taller pedagógico II", "Taller pedagógico I"],
      "Didáctica de las CS. sociales": ["Formación ciudadana en el párvulo", "Didáctica de las matemáticas"],
      "Taller Pedagógico IV": ["Taller pedagógico III", "Taller pedagógico II", "Taller pedagógico I"],
      "Taller pedagógico V": ["Taller Pedagógico IV", "Taller pedagógico III", "Taller pedagógico II", "Taller pedagógico I"],
      "Trabajo pedagógico en contextos diversos": ["Familia y su integración"],
      "Competencias en interculturalidad": ["Programas y exp. educativas"],
      "Internado pedagógico": ["Taller pedagógico V", "Taller Pedagógico IV", "Taller pedagógico III", "Taller pedagógico II", "Taller pedagógico I"],
      "Seminario": ["Investigación educativa"]
    };

    const malla = document.getElementById('malla');
    const estadoCursos = JSON.parse(localStorage.getItem('estadoCursos')) || {};

    function puedeAprobar(curso) {
      const pre = prerrequisitos[curso];
      return !pre || pre.every(p => estadoCursos[p]);
    }

    function crearCurso(nombre) {
      const div = document.createElement('div');
      div.className = 'course';
      div.textContent = nombre;

      if (estadoCursos[nombre]) {
        div.classList.add('approved');
      } else if (!puedeAprobar(nombre)) {
        div.classList.add('locked');
      }

      div.addEventListener('click', () => {
        if (div.classList.contains('locked')) return;

        estadoCursos[nombre] = !estadoCursos[nombre];
        actualizarEstado();
      });

      return div;
    }

    function actualizarEstado() {
      localStorage.setItem('estadoCursos', JSON.stringify(estadoCursos));

      document.querySelectorAll('.course').forEach(div => {
        const nombre = div.textContent;
        div.classList.remove('approved', 'locked');

        if (estadoCursos[nombre]) {
          div.classList.add('approved');
        } else if (!puedeAprobar(nombre)) {
          div.classList.add('locked');
        }
      });
    }

    function cargarMalla() {
      for (const semestre in cursos) {
        const h2 = document.createElement('h2');
        h2.textContent = semestre;
        malla.appendChild(h2);

        const contenedor = document.createElement('div');
        contenedor.className = 'semester';

        cursos[semestre].forEach(curso => {
          const cursoDiv = crearCurso(curso);
          contenedor.appendChild(cursoDiv);
        });

        malla.appendChild(contenedor);
      }
    }

    cargarMalla();
    actualizarEstado();
  </script>
</body>
</html>
